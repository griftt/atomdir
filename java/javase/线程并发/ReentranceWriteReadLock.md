###可重入读写锁 ReentrantReadWriteLock
  ####读写锁机制
  理解 ReentrantLock 和 AQS 之后，再来理解读写锁就很简单了。读写锁有一个读锁和一个写锁，分别对应读操作和锁操作。锁的特性如下：

只有一个线程可以获取到写锁。在获取写锁时，只有没有任何线程持有任何锁才能获取成功；
如果有线程正持有写锁，其他任何线程都获取不到任何锁；
没有线程持有写锁时，可以有多个线程获取到读锁。

上面锁的特点保证了可以并发读取，这大大提高了效率，在实际开发中非常有用。那么在具体是如何实现的呢？
实现原理
读写锁虽然有两个锁，但实际上只有一个等待队列。
>这种原理很类似数据的共享锁与排他锁。共享锁可被多个线程获得，排它锁只能被一个线程获得。 

* 获取写锁时，要保证没有任何线程持有锁；
* 写锁释放后，会唤醒队列第一个线程，可能是读锁和写锁；
* 获取读锁时，先判断写锁有没有被持有，没有就可以获取成功；
* 获取读锁成功后，会将队列中等待读锁的线程挨个唤醒，知道遇到等待写锁的线程位置；
* 释放读锁时，要检查读锁数，如果为0，则唤醒队列中的下一个线程，否则不进行操作。

作者：Tree1916
链接：https://juejin.im/post/5c37377351882525ec200f9e
来源：掘金
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
